{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/services/locator.ts","webpack:///./src/apps/viewer/actions/load-image.ts","webpack:///./src/models/fedora-model.ts","webpack:///./src/events/manager.ts","webpack:///./src/index.ts","webpack:///./src/application.ts","webpack:///./src/services/settings.ts","webpack:///./src/exceptions/application-not-run.ts","webpack:///./src/apps/viewer/index.ts","webpack:///./src/services/fullscreen.ts","webpack:///./src/apps/viewer/openseadragon/index.ts","webpack:///./src/apps/viewer/openseadragon/openseadragon.ts","webpack:///./src/services/fetch-large-image.ts","webpack:///./src/events/navigation/next.ts","webpack:///./src/events/navigation/previous.ts","webpack:///./src/events/navigation/keyboard-next.ts","webpack:///./src/events/navigation/keyboard-previous.ts","webpack:///./src/apps/viewer/basic/index.ts","webpack:///./src/apps/viewer/basic/basic.ts","webpack:///./src/events/navigation/mouse-move.ts","webpack:///./src/apps/viewer/nav-textual.ts","webpack:///./src/apps/modal.ts","webpack:///./src/events/modal/open.ts","webpack:///./src/models/modal-template.ts","webpack:///./src/events/modal/close.ts","webpack:///./src/services/navigation.ts","webpack:///./src/animations/animation.ts","webpack:///./src/animations/fade-out.ts","webpack:///./src/services/link-generator.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ServiceLocator","Map","default","LoadImageAction","image","this","getImage","FedoraModel","EventManager","add","event","target","addEventListener","type","listener","useCapture","remove","removeEventListener","application_1","jq","Drupal","behaviors","FlatGalleryNew","attach","context","settings","Application","run","detach","jQuery","locator_1","settings_1","application_not_run_1","viewer_1","modal_1","navigation_1","link_generator_1","apps","bootstrap","set","flat_gallery","islandora_open_seadragon_viewer","isModalSettings","push","isDefaultSettings","default_settings","navigation","current_id","images","fedora","base_url","forEach","app","action","item","undefined","modal","url","openseadragon","ApplicationNotRun","_super","__extends","Error","fullscreen_1","openseadragon_1","manager_1","next_1","previous_1","keyboard_next_1","keyboard_previous_1","basic_1","mouse_move_1","load_image_1","nav_textual_1","ViewerApp","viewers","navTextual","viewer","render","Element","requestFullscreen","mozRequestFullscreen","webkitRequestFullscreen","msRequestFullscreen","document","exitFullscreen","mozExitFullscreen","webkitExitFullscreen","msExitFullscreen","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","fedora_model_1","OpenseadragonViewer","options","id","setup","model","Large","fetch_large_image_1","OpenseadragonViewModel","base","fullscreen","_this","buttons","button","tooltip","addHandler","enterFullscreen","preventDefaultAction","fullscreenchange","leaveFullscreen","querySelector","then","openseadragonElement","lastChild","removeChild","appendChild","classList","show","current","hide","viewerElement","cleanBaseElement","islandoraOpenSeadragon","djatokaServerBaseURL","IslandoraOpenSeadragonViewer","baseElement","newBaseElement","createElement","setAttribute","substring","fetch","_a","sent","json","NavigationNextEvent","application","hasAttribute","getAttribute","preventDefault","next","NavigationPreviousEvent","previous","KeyboardNextEvent","which","keyCode","KeyboardPreviousEvent","BasicViewer","basic","Basic","renderImage","BasicViewModel","eventsBound","basicElement","imageElement","captionsElement","toString","descriptions","length","description","captionElement","textContent","MouseMoveEvent","stopHidingNavigation","NavTextualViewModel","generator","links","generateNavigationLinks","navTextualElement","link","console","log","open_1","close_1","ModalApp","modal_template_1","ModalOpenEvent","template","body","window","scrollTo","setTimeout","parentNode","element","innerHTML","trim","firstChild","ModalCloseEvent","container","transitionend","animation_1","fade_out_1","Navigation","animation","all","getNextImage","nextImageAvailable","getPreviousImage","previousImageAvailable","nextElement","previousElement","currentImage","querySelectorAll","thumbnail","hideNavigation","running","enqueue","animate","style","opacity","stop","clearTimeout","hideNavigationTimeout","Animation","queue","framerate","effect","frame","timer","setInterval","process","done","clearInterval","FadeOutAnimation","from","to","speed","frames","tween","LinkGenerator","baseUrl","createTextNode"],"mappings":"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","file":"../../js/flat-gallery-app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","export const ServiceLocator = new Map<string, any>();\nexport default ServiceLocator;\n","import Action from \"@fg-apps/viewer/actions/action\";\nimport Image from \"@fg-models/image\";\n\nexport default class LoadImageAction implements Action {\n\n    private image: Image;\n\n    constructor(image: Image) {\n        this.image = image;\n    }\n\n    getImage() {\n        return this.image;\n    }\n}\n","/**\n * Defining which kinds of models this application\n * supports, we use this enum.\n *\n * @author  Ibrahim Abdullah <ibrahim.abdullah@mpi.nl>\n * @package Flat Gallery\n */\nexport enum FedoraModel {\n\n  /**\n   * Simple {@link HTMLImageElement} will be displayed\n   */\n  Basic = 'islandora:sp_basic_image',\n\n  /**\n   * Openseadragon viewer will be displayed\n   */\n  Large = 'islandora:sp_large_image_cmodel',\n};\n","import { Event as CustomEvent } from \"@fg-events/event\";\n\nexport class EventManager {\n\n    add(event: CustomEvent) {\n        event.target.addEventListener(event.type, event.listener.bind(event), event.useCapture);\n    }\n\n    remove(event: CustomEvent) {\n        event.target.removeEventListener(event.type, event.listener.bind(event), event.useCapture);\n    }\n}\n\nexport default new EventManager();\n","import { Application } from \"./application\";\nimport Settings, { DefaultSettings } from \"@fg-services/settings\";\n\n(function (jq, Drupal) {\n\n    Drupal.behaviors.FlatGalleryNew = {\n\n        attach(context, settings: Settings) {\n\n            let application = new Application();\n            application.run(settings);\n        },\n\n        detach(context) {\n        }\n    };\n\n}(jQuery, Drupal));\n","import ServiceLocator from \"@fg-services/locator\";\nimport { Settings, isModalSettings, isDefaultSettings, DefaultSettings } from \"@fg-services/settings\";\nimport ApplicationNotRun from \"@fg-exceptions/application-not-run\";\nimport ViewerApp from \"@fg-apps/viewer\";\nimport ModalApp from \"@fg-apps/modal\";\nimport App from \"@fg-apps/app\";\nimport Navigation from \"@fg-services/navigation\";\nimport Action from \"@fg-apps/viewer/actions/action\";\nimport Animation from \"@fg-animations/animation\";\nimport FadeOutAnimation from \"@fg-animations/fade-out\";\nimport LinkGenerator from \"@fg-services/link-generator\";\n\nexport class Application {\n\n  private apps: App[] = [];\n\n  bootstrap(settings: Settings) {\n\n    ServiceLocator.set('app', this);\n    ServiceLocator.set('settings', settings.flat_gallery);\n    ServiceLocator.set('openseadragon', settings.islandora_open_seadragon_viewer);\n\n    if (null == settings.flat_gallery) {\n\n      // application should not run if\n      // settings aren't passed through\n      throw new ApplicationNotRun('FLAT Gallery settings missing (Drupal.settings.flat_gallery)');\n    }\n\n    if (true === isModalSettings(settings.flat_gallery)) {\n      this.apps.push(new ModalApp());\n    }\n\n    if (true === isDefaultSettings(settings.flat_gallery)) {\n\n      let default_settings = (settings.flat_gallery as DefaultSettings);\n      let navigation       = new Navigation(default_settings.current_id, default_settings.images);\n\n      ServiceLocator.set('link-generator', new LinkGenerator(navigation, default_settings.fedora.base_url));\n      ServiceLocator.set('navigation', navigation);\n\n      this.apps.push(new ViewerApp());\n    }\n  }\n\n  run(settings: Settings) {\n\n    this.bootstrap(settings);\n\n    this.apps.forEach((app) => {\n      app.run();\n    });\n  }\n\n  action(action: Action) {\n\n    this.apps.forEach((app) => {\n      app.action(action);\n    });\n  }\n}\n","import { Image } from \"../models/image\";\n/**\n * All the settings interfaces applicable to Flat Gallery\n *\n * @author  Ibrahim Abdullah <ibrahim.abdullah@mpi.nl>\n * @package Flat Gallery\n */\n/**\n * These are the openseadragon main settings that will be\n * used to create an instance of openseadragon.\n * This can either be sent in on page load (if first image\n * is an Large Image), or it can be sent over via AJAX.\n */\nexport interface OpenseadragonSettings {\n\n    djatokaServerBaseURL: string;\n    fitToAspectRatio: number;\n    iiifServerBaseURL: string;\n    imageServer: string;\n\n    options: {\n\n        /**\n         * We will always have the id inside the options\n         * so let's make it explicit\n         */\n        id: string;\n\n        /**\n         * All the other options are implicit, so we do not\n         * need to define them here.\n         */\n        [k: string]: any;\n    };\n\n    /**\n     * This is the PID of the Large Image we are going to load\n     */\n    pid: string;\n}\n\n/**\n * This interface will be sent to us if the first image\n * loaded is not a Large Image. We will then use the options.id\n * to dynamically create an Openseadragon instance\n */\nexport interface OptionsIdSettings {\n\n    options: {\n        id: string;\n    };\n}\n\nexport interface FedoraSettings {\n\n    pid: string;\n    label: string;\n    base_url: string;\n}\n\nexport interface DefaultSettings {\n\n    fedora: FedoraSettings;\n\n    current_id: number;\n\n    /**\n     * Flat Gallery sends us either an array of images\n     * or it sends us an empty array if no images are found.\n     */\n    images: [Image];\n\n    /**\n     * Openseadragon has a couple of settings already preloaded\n     * if the first image in the previewer is a Large Image so it\n     * will send {@link OpenseadragonSettings}\n     * Or else it sends us a clean array with just the {@link OptionsIdSettings}.\n     */\n    openseadragon: OpenseadragonSettings | OptionsIdSettings;\n}\n\n/**\n * This interface will be sent to use if we only want\n * to bind the modal event binding.\n */\nexport interface ModalSettings {\n\n    modal: true;\n    url: string;\n}\n\nexport interface OpenseadragonInstance {\n    addHandler: (event: string, handler: (options: {[k: string]: any}) => any) => any\n    buttons: any;\n}\n\n/**\n * Because of how Drupal works, Drupal.behaviors will\n * always be called on every page. To make sure we only run\n * the application, flat_gallery can either be this definition\n * or null | undefined\n */\nexport interface Settings {\n\n    flat_gallery: DefaultSettings | ModalSettings | null | undefined;\n\n    islandora_open_seadragon_viewer: OpenseadragonInstance | null | undefined;\n}\n\nexport function isModalSettings(item: any): item is ModalSettings {\n    return (<ModalSettings>item).modal !== undefined && (<ModalSettings>item).url !== undefined;\n}\n\nexport function isDefaultSettings(item: any): item is DefaultSettings {\n    return (<DefaultSettings>item).images !== undefined && (<DefaultSettings>item).openseadragon !== undefined;\n}\n\nexport default Settings;\n","export default class ApplicationNotRun extends Error {}\n","import FixFullscreenCompatibility from \"@fg-services/fullscreen\";\nimport App from \"@fg-apps/app\";\nimport Viewer from \"@fg-apps/viewer/viewer\";\nimport OpenseadragonViewer from \"./openseadragon\";\nimport EventManager from \"@fg-events/manager\";\nimport NavigationNextEvent from \"@fg-events/navigation/next\";\nimport NavigationPreviousEvent from \"@fg-events/navigation/previous\";\nimport KeyboardNextEvent from \"@fg-events/navigation/keyboard-next\";\nimport KeyboardPreviousEvent from \"@fg-events/navigation/keyboard-previous\";\nimport BasicViewer from \"@fg-apps/viewer/basic\";\nimport Action from \"@fg-apps/viewer/actions/action\";\nimport MouseMoveEvent from \"@fg-events/navigation/mouse-move\";\nimport LoadImageAction from \"./actions/load-image\";\nimport ServiceLocator from \"@fg-services/locator\";\nimport LinkGenerator from \"@fg-services/link-generator\";\nimport NavTextualViewModel from \"@fg-apps/viewer/nav-textual\";\n\nexport default class ViewerApp implements App {\n\n    private navTextual: NavTextualViewModel;\n\n    private viewers: Viewer[] = [\n\n        new OpenseadragonViewer(),\n        new BasicViewer(),\n    ];\n\n    bootstrap() {\n\n        FixFullscreenCompatibility();\n\n        EventManager.add(new NavigationNextEvent());\n        EventManager.add(new NavigationPreviousEvent());\n        EventManager.add(new KeyboardNextEvent());\n        EventManager.add(new KeyboardPreviousEvent());\n        EventManager.add(new MouseMoveEvent());\n\n        this.navTextual = new NavTextualViewModel(ServiceLocator.get('link-generator') as LinkGenerator);\n    }\n\n    run() {\n\n        this.bootstrap();\n\n        this.viewers.forEach((viewer: Viewer) => {\n            viewer.run();\n        });\n    }\n\n    action(action: Action) {\n\n        if (action instanceof LoadImageAction) {\n            this.navTextual.render();\n        }\n\n        this.viewers.forEach((viewer: Viewer) => {\n            viewer.action(action);\n        });\n    }\n}\n","export default function FixFullscreenCompatibility() {\n\n    if (!Element.prototype.requestFullscreen) {\n        Element.prototype.requestFullscreen = Element.prototype.mozRequestFullscreen || Element.prototype.webkitRequestFullscreen || Element.prototype.msRequestFullscreen;\n    }\n\n    if (!document.exitFullscreen) {\n        document.exitFullscreen = document.mozExitFullscreen || document.webkitExitFullscreen || document.msExitFullscreen;\n    }\n\n    if (!document.fullscreenElement) {\n        document.fullscreenElement = document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;\n    }\n}\n","import Viewer from \"@fg-apps/viewer/viewer\";\nimport OpenseadragonViewModel from \"@fg-apps/viewer/openseadragon/openseadragon\";\nimport Action from \"../actions/action\";\nimport LoadImageAction from \"../actions/load-image\";\nimport { FedoraModel } from \"@fg-models/fedora-model\";\nimport ServiceLocator from \"@fg-services/locator\";\nimport { DefaultSettings } from \"@fg-services/settings\";\n\nexport default class OpenseadragonViewer implements Viewer {\n\n  private openseadragon: OpenseadragonViewModel;\n\n  run() {\n\n    let settings = (ServiceLocator.get('settings') as DefaultSettings);\n\n    this.openseadragon = new OpenseadragonViewModel(settings.openseadragon.options.id);\n    this.openseadragon.setup();\n  }\n\n  action(action: Action) {\n\n    if (action instanceof LoadImageAction && action.getImage().model === FedoraModel.Large) {\n      this.openseadragon.create(action.getImage());\n    }\n  }\n}\n","import ServiceLocator from \"@fg-services/locator\";\nimport { OpenseadragonInstance } from \"@fg-services/settings\";\nimport Navigation from \"@fg-services/navigation\";\nimport Image from \"@fg-models/image\";\nimport FetchLargeImage from \"@fg-services/fetch-large-image\";\nimport { FedoraModel } from \"@fg-models/fedora-model\";\n\nexport default class OpenseadragonViewModel {\n\n    private base: string;\n    private fullscreen: boolean;\n\n    constructor(base) {\n\n        this.base       = '#' + base;\n        this.fullscreen = false;\n    }\n\n    setup() {\n\n        let openseadragon = (ServiceLocator.get('openseadragon') as OpenseadragonInstance);\n\n        if (null == openseadragon) {\n            return;\n        }\n\n        openseadragon.buttons.buttons.forEach((button) => {\n\n            if (button.tooltip === 'Toggle full page') {\n\n                button.addHandler('click', (options) => {\n\n                    if (false === this.fullscreen) {\n                        this.enterFullscreen();\n                    } else {\n                        // calling document.exitFullscreen instead of this.leaveFullscreen\n                        // because listeners on fullscreenchange already call it\n                        document.exitFullscreen();\n                    }\n                });\n            }\n        });\n\n        openseadragon.addHandler('pre-full-screen', (options) => {\n            options.preventDefaultAction = true;\n        });\n\n        let fullscreenchange = this.leaveFullscreen.bind(this);\n\n        document.addEventListener('fullscreenchange', fullscreenchange);\n        document.addEventListener('webkitfullscreenchange', fullscreenchange);\n        document.addEventListener('mozfullscreenchange', fullscreenchange);\n        document.addEventListener('MSFullscreenChange', fullscreenchange);\n    }\n\n    enterFullscreen() {\n\n        if (true === this.fullscreen) {\n            return;\n        }\n\n        this.fullscreen = true;\n        let fullscreenRequestElement = document.querySelector('[data-role=\"flat-gallery-fullscreen\"]');\n\n        fullscreenRequestElement\n            .requestFullscreen()\n            .then(() => {\n\n                let fullscreenElement    = document.querySelector('[data-role=\"flat-gallery-fullscreen-element\"]');\n                let openseadragonElement = document.querySelector(this.base);\n\n                while (fullscreenElement.lastChild) {\n                    fullscreenElement.removeChild(fullscreenElement.lastChild);\n                }\n\n                fullscreenElement.appendChild(openseadragonElement);\n                openseadragonElement.classList.add('flat-gallery-openseadragon-fullscreen');\n\n                let navigation = ServiceLocator.get('navigation') as Navigation;\n                navigation.show();\n                navigation.render();\n            });\n    }\n\n    leaveFullscreen() {\n\n        let navigation = ServiceLocator.get('navigation') as Navigation;\n\n        if (null === document.fullscreenElement && true === this.fullscreen && navigation.current().model === FedoraModel.Large) {\n\n            this.fullscreen = false;\n\n            navigation.hide();\n\n            let viewerElement        = document.querySelector('[data-role=\"flat-gallery-viewer\"]');\n            let openseadragonElement = document.querySelector(this.base);\n\n            while (viewerElement.lastChild) {\n                viewerElement.removeChild(viewerElement.lastChild);\n            }\n\n            openseadragonElement.classList.remove('flat-gallery-openseadragon-fullscreen');\n            viewerElement.appendChild(openseadragonElement);\n        }\n    }\n\n    create(image: Image) {\n\n        this.cleanBaseElement();\n\n        FetchLargeImage(image)\n            .then((settings) => {\n\n                Drupal.settings.islandoraOpenSeadragon.djatokaServerBaseURL = settings.djatokaServerBaseURL;\n                Drupal.IslandoraOpenSeadragonViewer[this.base] = new Drupal.IslandoraOpenSeadragonViewer(this.base, settings);\n\n                ServiceLocator.set('openseadragon', Drupal.settings.islandora_open_seadragon_viewer);\n\n                this.setup();\n            });\n    }\n\n    cleanBaseElement() {\n\n        if (typeof Drupal.IslandoraOpenSeadragonViewer === 'undefined') {\n            return;\n        }\n\n        let viewerElement  = null;\n        let baseElement    = document.querySelector(this.base);\n        let newBaseElement = document.createElement('div');\n\n        newBaseElement.setAttribute('id', this.base.substring(1)); // removing # from base name\n        newBaseElement.classList.add('islandora-openseadragon');\n\n        if (null === document.fullscreenElement) {\n\n            // out of fullscreen\n            viewerElement = document.querySelector('[data-role=\"flat-gallery-viewer\"]');\n\n            this.fullscreen = false;\n\n        } else {\n\n            // inside fullscreen\n            viewerElement = document.querySelector('[data-role=\"flat-gallery-fullscreen-element\"]');\n            newBaseElement.classList.add('flat-gallery-openseadragon-fullscreen');\n\n            this.fullscreen = true;\n        }\n\n        if (null != baseElement) {\n\n            // removing current baseElement\n            baseElement.remove();\n        }\n\n        // cleaning viewer element\n        while (viewerElement.lastChild) {\n            viewerElement.removeChild(viewerElement.lastChild);\n        }\n\n        // and adding new base element\n        viewerElement.appendChild(newBaseElement);\n\n        // finally removing it from cache\n        delete Drupal.IslandoraOpenSeadragonViewer[this.base];\n    }\n}\n","import Image from \"@fg-models/image\";\nimport { DefaultSettings } from \"./settings\";\nimport ServiceLocator from \"./locator\";\n\nexport default async function FetchLargeImage(image: Image) {\n\n  let url      = (ServiceLocator.get('settings') as DefaultSettings).fedora.base_url + '/ajax';\n  let response = await fetch(`${url}/${image.id}`);\n\n  return await response.json();\n}\n","import { Event as CustomEvent } from \"@fg-events/event\";\nimport ServiceLocator from \"@fg-services/locator\";\nimport Navigation from \"@fg-services/navigation\";\nimport { Application } from \"@fg-application\";\nimport LoadImageAction from \"@fg-apps/viewer/actions/load-image\";\n\nexport default class NavigationNextEvent implements CustomEvent {\n\n    type: string;\n    target: EventTarget;\n    useCapture: boolean;\n    application: Application;\n    navigation: Navigation;\n\n    constructor() {\n\n        this.type        = 'click';\n        this.useCapture  = false;\n        this.target      = document;\n        this.application = ServiceLocator.get('app') as Application;\n        this.navigation  = ServiceLocator.get('navigation') as Navigation;\n    }\n\n    listener(event: Event) {\n\n        let target = (event.target as Element);\n\n        if (target.hasAttribute('data-flat-gallery-nav') && target.getAttribute('data-flat-gallery-nav') === 'next') {\n\n            event.preventDefault();\n\n            this.navigation.next();\n            this.navigation.render();\n\n            this.application.action(\n                new LoadImageAction(\n                    this.navigation.current()\n                )\n            );\n        }\n    }\n}\n","import { Event as CustomEvent } from \"@fg-events/event\";\nimport ServiceLocator from \"@fg-services/locator\";\nimport Navigation from \"@fg-services/navigation\";\nimport { Application } from \"@fg-application\";\nimport LoadImageAction from \"@fg-apps/viewer/actions/load-image\";\n\nexport default class NavigationPreviousEvent implements CustomEvent {\n\n    type: string;\n    target: EventTarget;\n    useCapture: boolean;\n    application: Application;\n    navigation: Navigation;\n\n    constructor() {\n\n        this.type        = 'click';\n        this.useCapture  = false;\n        this.target      = document;\n        this.application = ServiceLocator.get('app') as Application;\n        this.navigation  = ServiceLocator.get('navigation') as Navigation;\n    }\n\n    listener(event: Event) {\n\n        let target = (event.target as Element);\n\n        if (target.hasAttribute('data-flat-gallery-nav') && target.getAttribute('data-flat-gallery-nav') === 'previous') {\n\n            event.preventDefault();\n\n            this.navigation.previous();\n            this.navigation.render();\n\n            this.application.action(\n                new LoadImageAction(\n                    this.navigation.current()\n                )\n            );\n        }\n    }\n}\n","import { Event as CustomEvent } from \"@fg-events/event\";\nimport ServiceLocator from \"@fg-services/locator\";\nimport Navigation from \"@fg-services/navigation\";\nimport { Application } from \"@fg-application\";\nimport LoadImageAction from \"@fg-apps/viewer/actions/load-image\";\n\nexport default class KeyboardNextEvent implements CustomEvent {\n\n    type: string;\n    target: EventTarget;\n    useCapture: boolean;\n    application: Application;\n    navigation: Navigation;\n\n    constructor() {\n\n        this.type        = 'keyup';\n        this.useCapture  = false;\n        this.target      = document;\n        this.application = ServiceLocator.get('app') as Application;\n        this.navigation  = ServiceLocator.get('navigation') as Navigation;\n    }\n\n    listener(event: KeyboardEvent) {\n\n        let keyboard = event.which || event.keyCode || 0;\n\n        if (keyboard === 39) {\n\n            event.preventDefault();\n\n            this.navigation.next();\n            this.navigation.render();\n\n            this.application.action(\n                new LoadImageAction(\n                    this.navigation.current()\n                )\n            );\n        }\n    }\n}\n","import { Event as CustomEvent } from \"@fg-events/event\";\nimport ServiceLocator from \"@fg-services/locator\";\nimport Navigation from \"@fg-services/navigation\";\nimport { Application } from \"@fg-application\";\nimport LoadImageAction from \"@fg-apps/viewer/actions/load-image\";\n\nexport default class KeyboardPreviousEvent implements CustomEvent {\n\n    type: string;\n    target: EventTarget;\n    useCapture: boolean;\n    application: Application;\n    navigation: Navigation;\n\n    constructor() {\n\n        this.type        = 'keyup';\n        this.useCapture  = false;\n        this.target      = document;\n        this.application = ServiceLocator.get('app') as Application;\n        this.navigation  = ServiceLocator.get('navigation') as Navigation;\n    }\n\n    listener(event: KeyboardEvent) {\n\n        let keyboard = event.which || event.keyCode || 0;\n\n        if (keyboard === 37) {\n\n            event.preventDefault();\n\n            this.navigation.previous();\n            this.navigation.render();\n\n            this.application.action(\n                new LoadImageAction(\n                    this.navigation.current()\n                )\n            );\n        }\n    }\n}\n","import Viewer from \"@fg-apps/viewer/viewer\";\nimport BasicViewModel from \"@fg-apps/viewer/basic/basic\";\nimport Action from \"@fg-apps/viewer/actions/action\";\nimport LoadImageAction from \"@fg-apps/viewer/actions/load-image\";\nimport { FedoraModel } from \"@fg-models/fedora-model\";\nimport ServiceLocator from \"@fg-services/locator\";\nimport LinkGenerator from \"@fg-services/link-generator\";\n\nexport default class BasicViewer implements Viewer {\n\n    private basic: BasicViewModel;\n\n    run() {\n\n        this.basic = new BasicViewModel();\n        this.basic.setup();\n    }\n\n    action(action: Action) {\n\n        if (action instanceof LoadImageAction && action.getImage().model === FedoraModel.Basic) {\n\n            this.basic.setup();\n            this.basic.renderImage(action.getImage());\n        }\n    }\n}\n","import ServiceLocator from \"@fg-services/locator\";\nimport Navigation from \"@fg-services/navigation\";\nimport { FedoraModel } from \"@fg-models/fedora-model\";\nimport Image from \"@fg-models/image\";\n\nexport default class BasicViewModel {\n\n    private fullscreen: boolean;\n    private eventsBound: boolean;\n\n    constructor() {\n\n        this.fullscreen  = false;\n        this.eventsBound = false;\n    }\n\n    setup() {\n\n        if (true === this.eventsBound) {\n            return;\n        }\n\n        let navigation = (ServiceLocator.get('navigation') as Navigation);\n\n        if (navigation.current().model !== FedoraModel.Basic) {\n            return;\n        }\n\n        document.addEventListener('click', this.enterFullscreen.bind(this));\n\n        let fullscreenchange = this.leaveFullscreen.bind(this);\n\n        document.addEventListener('fullscreenchange', fullscreenchange);\n        document.addEventListener('webkitfullscreenchange', fullscreenchange);\n        document.addEventListener('mozfullscreenchange', fullscreenchange);\n        document.addEventListener('MSFullscreenChange', fullscreenchange);\n\n        this.eventsBound = true;\n    }\n\n    enterFullscreen(event: Event) {\n\n        let target = (event.target as Element);\n        if (target.getAttribute('data-role') === 'flat-gallery-toggle-fullscreen') {\n\n            if (true === this.fullscreen) {\n                return;\n            }\n\n            this.fullscreen = true;\n            let fullscreenRequestElement = document.querySelector('[data-role=\"flat-gallery-fullscreen\"]');\n\n            fullscreenRequestElement\n                .requestFullscreen()\n                .then(() => {\n\n                    let navigation = ServiceLocator.get('navigation') as Navigation;\n                    navigation.show();\n                    navigation.render();\n\n                    this.renderImage(navigation.current());\n                });\n        }\n    }\n\n    leaveFullscreen() {\n\n        let navigation = ServiceLocator.get('navigation') as Navigation;\n\n        if (null === document.fullscreenElement && true === this.fullscreen && navigation.current().model === FedoraModel.Basic) {\n\n            this.fullscreen = false;\n\n            navigation.hide();\n\n            let viewerElement  = document.querySelector('[data-role=\"flat-gallery-viewer\"]');\n            let basicElement   = document.querySelector('[data-role=\"flat-gallery-toggle-fullscreen\"]');\n\n            while (viewerElement.lastChild) {\n                viewerElement.removeChild(viewerElement.lastChild);\n            }\n\n            viewerElement.appendChild(basicElement);\n\n            let fullscreenElement = document.querySelector('[data-role=\"flat-gallery-fullscreen-element\"]');\n\n            while (fullscreenElement.lastChild) {\n                fullscreenElement.removeChild(fullscreenElement.lastChild);\n            }\n        }\n    }\n\n    renderImage(image: Image) {\n\n        let viewerElement   =  null;\n        let imageElement    = document.createElement('img');\n        let captionsElement = document.createElement('div');\n\n        imageElement.setAttribute('data-role', 'flat-gallery-toggle-fullscreen');\n        imageElement.setAttribute('data-flat-gallery-id', image.id.toString());\n        imageElement.setAttribute('src', image.object);\n        imageElement.classList.add('flat-gallery-basic-image');\n\n        captionsElement.classList.add('hidden');\n\n        if (null === document.fullscreenElement) {\n\n            viewerElement   = document.querySelector('[data-role=\"flat-gallery-viewer\"]');\n            this.fullscreen = false;\n\n        } else {\n\n            viewerElement   = document.querySelector('[data-role=\"flat-gallery-fullscreen-element\"]');\n            this.fullscreen = true;\n        }\n\n        while (viewerElement.lastChild) {\n            viewerElement.removeChild(viewerElement.lastChild);\n        }\n\n        if (image.descriptions.length > 0 && true === this.fullscreen) {\n\n            captionsElement.classList.remove('hidden');\n            captionsElement.classList.add('flat-gallery-viewer-caption');\n            captionsElement.setAttribute('data-role', 'flat-gallery-captions');\n\n            image.descriptions.forEach((description) => {\n\n                let captionElement = document.createElement('span');\n                captionElement.textContent = description;\n\n                captionsElement.appendChild(captionElement);\n            });\n        }\n\n        viewerElement.appendChild(imageElement);\n        viewerElement.appendChild(captionsElement);\n    }\n}\n","import { Event as CustomEvent } from \"@fg-events/event\";\nimport ServiceLocator from \"@fg-services/locator\";\nimport Navigation from \"@fg-services/navigation\";\n\nexport default class MouseMoveEvent implements CustomEvent {\n\n    type: string;\n    target: EventTarget;\n    useCapture: boolean;\n    navigation: Navigation;\n\n    constructor() {\n\n        this.type       = 'mousemove';\n        this.useCapture = false;\n        this.target     = document;\n        this.navigation = ServiceLocator.get('navigation') as Navigation;\n    }\n\n    listener(event: MouseEvent) {\n        this.navigation.stopHidingNavigation();\n    }\n}\n","import LinkGenerator from \"@fg-services/link-generator\";\n\nexport default class NavTextualViewModel {\n\n    private generator: LinkGenerator;\n\n    constructor(generator: LinkGenerator) {\n        this.generator = generator;\n    }\n\n    render() {\n\n        let links             = this.generator.generateNavigationLinks();\n        let navTextualElement = document.querySelector('[data-role=\"flat-gallery-nav-textual\"]');\n\n        while (navTextualElement.lastChild) {\n            navTextualElement.removeChild(navTextualElement.lastChild);\n        }\n\n        links.forEach((link) => {\n            console.log(link);\n            navTextualElement.appendChild(link);\n        });\n    }\n}\n","import EventManager from \"@fg-events/manager\";\nimport ModalOpenEvent from \"@fg-events/modal/open\";\nimport ModalCloseEvent from \"@fg-events/modal/close\";\nimport App from \"@fg-apps/app\";\n\nexport default class ModalApp implements App {\n\n    action() {}\n\n    run() {\n\n        EventManager.add(new ModalOpenEvent());\n        EventManager.add(new ModalCloseEvent());\n    }\n}\n","import { Event as CustomEvent } from \"@fg-events/event\";\nimport ModalTemplate from \"@fg-models/modal-template\";\nimport ServiceLocator from \"@fg-services/locator\";\nimport { ModalSettings } from \"@fg-services/settings\";\n\nexport default class ModalOpenEvent implements CustomEvent {\n\n    type: string;\n    target: EventTarget;\n    useCapture: boolean;\n\n    constructor() {\n\n        this.type       = 'click';\n        this.useCapture = false;\n        this.target     = document;\n    }\n\n    listener(event: Event) {\n\n        let target = (event.target as Element);\n        if (target.getAttribute('data-role') === 'flat-gallery-modal') {\n\n            event.preventDefault();\n\n            let template = ModalTemplate((ServiceLocator.get('settings') as ModalSettings).url);\n            let body     = document.querySelector('body');\n\n            window.scrollTo(0, 0);\n            body.appendChild(template);\n\n            setTimeout(() => {\n\n                // adding timeout to allow for css transition\n                // to be called\n                let content = document.querySelector('[data-role=\"flat-gallery-modal-content\"]');\n                (content.parentNode as Element).classList.add('fade-to');\n            });\n        }\n    }\n}\n","/**\n * Creating modal from template\n *\n * @author  Ibrahim Abdullah <ibrahim.abdullah@mpi.nl>\n * @package Flat Gallery\n */\n/**\n * @param url string\n *\n * @return Element\n */\nconst ModalTemplate = (url: string) : Node => {\n\n    let template = `\n        <div class=\"flat-gallery-modal\" data-role=\"flat-gallery-modal-container\">\n            <div class=\"flat-gallery-modal-overlay\"></div>\n            <div class=\"flat-gallery-modal-content-container\">\n                <a href=\"#\" class=\"flat-gallery-modal-close\" data-role=\"flat-gallery-modal-close\"></a>\n                <div class=\"flat-gallery-modal-content\" data-role=\"flat-gallery-modal-content\">\n                    <iframe allowfullscreen=\"true\" allow=\"fullscreen\" src=\"${url}\"></iframe>\n                </div>\n            </div>\n        </div>\n    `;\n\n    let element = document.createElement('div');\n    element.innerHTML = template.trim();\n\n    return element.firstChild;\n};\n\nexport default ModalTemplate;\n","import { Event as CustomEvent } from \"@fg-events/event\";\n\nexport default class ModalCloseEvent implements CustomEvent {\n\n    type: string;\n    target: EventTarget;\n    useCapture: boolean;\n\n    constructor() {\n\n        this.type       = 'click';\n        this.useCapture = false;\n        this.target     = document;\n    }\n\n    listener(event: Event) {\n\n        let target = (event.target as Element);\n\n        if (target.getAttribute('data-role') === 'flat-gallery-modal-close') {\n\n            let content       = document.querySelector('[data-role=\"flat-gallery-modal-content\"]');\n            let container     = (content.parentNode as Element);\n            let modal         = document.querySelector('[data-role=\"flat-gallery-modal-container\"]');\n            let transitionend = modal.remove.bind(modal);\n\n            container.addEventListener('transitionend', transitionend);\n            container.addEventListener('webkitTransitionEnd', transitionend);\n            container.addEventListener('mozTransitionEnd', transitionend);\n            container.addEventListener('oTransitionEnd', transitionend);\n            container.addEventListener('MSTransitionEnd', transitionend);\n\n            container.classList.remove('fade-to');\n        }\n    }\n}\n","import Image from \"@fg-models/image\";\nimport Animation from \"@fg-animations/animation\";\nimport FadeOutAnimation from \"@fg-animations/fade-out\";\n\nexport default class Navigation {\n\n    private id: number;\n    private images: Image[];\n    private animation: Animation;\n    private hideNavigationTimeout: number;\n\n    constructor(current_id: number, images: Image[]) {\n\n        this.id        = current_id;\n        this.images    = images;\n        this.animation = new Animation();\n    }\n\n    all() {\n        return this.images;\n    }\n\n    current() {\n        return this.images[this.id];\n    }\n\n    getNextImage() {\n\n        if (false === this.nextImageAvailable()) {\n            return false;\n        }\n\n        return this.images[this.id + 1];\n    }\n\n    nextImageAvailable() {\n        return null != this.images[this.id + 1];\n    }\n\n    next() {\n\n        if (false === this.nextImageAvailable()) {\n            return false;\n        }\n\n        this.id += 1;\n\n        return this.images[this.id];\n    }\n\n    getPreviousImage() {\n\n        if (false === this.previousImageAvailable()) {\n            return false;\n        }\n\n        return this.images[this.id - 1];\n    }\n\n    previousImageAvailable() {\n        return null != this.images[this.id - 1];\n    }\n\n    previous() {\n\n        if (false === this.previousImageAvailable()) {\n            return false;\n        }\n\n        this.id -= 1;\n\n        return this.images[this.id];\n    }\n\n    show() {\n\n        let navigationElement = document.querySelector('[data-role=\"flat-gallery-nav\"]');\n        navigationElement.classList.remove('hidden');\n    }\n\n    hide() {\n\n        let navigationElement = document.querySelector('[data-role=\"flat-gallery-nav\"]');\n        navigationElement.classList.add('hidden');\n    }\n\n    render() {\n\n        let nextElement            = document.querySelector('[data-flat-gallery-nav=\"next\"]');\n        let previousElement        = document.querySelector('[data-flat-gallery-nav=\"previous\"]');\n\n        let nextImageAvailable     = this.nextImageAvailable();\n        let previousImageAvailable = this.previousImageAvailable();\n        let currentImage           = this.current();\n\n        nextElement.classList.add('hidden');\n        previousElement.classList.add('hidden');\n\n        if (true === nextImageAvailable) {\n            nextElement.classList.remove('hidden');\n        }\n\n        if (true === previousImageAvailable) {\n            previousElement.classList.remove('hidden');\n        }\n\n        document.querySelectorAll('[data-role=\"flat-gallery-thumbnail\"] a').forEach((thumbnail) => {\n            thumbnail.classList.remove('active');\n        });\n\n        let currentThumbnailElement = document.querySelector(`[data-role=\"flat-gallery-thumbnail\"][data-flat-gallery-id=\"${currentImage.id}\"] a`);\n        currentThumbnailElement.classList.add('active');\n\n        // starting up animating arrow fade out\n        this.stopHidingNavigation();\n    }\n\n    hideNavigation() {\n\n        if (false === this.animation.running) {\n\n            let nextElement     = document.querySelector('[data-flat-gallery-nav=\"next\"]') as HTMLElement;\n            let previousElement = document.querySelector('[data-flat-gallery-nav=\"previous\"]') as HTMLElement;\n            let captionsElement = document.querySelector('[data-role=\"flat-gallery-captions\"]') as HTMLElement;\n\n            this.animation.enqueue(new FadeOutAnimation(previousElement, 100, 0, 1));\n            this.animation.enqueue(new FadeOutAnimation(nextElement, 100, 0, 1));\n            this.animation.enqueue(new FadeOutAnimation(captionsElement, 100, 0, 1));\n            this.animation.animate();\n        }\n    }\n\n    stopHidingNavigation() {\n\n        if (null === document.fullscreenElement) {\n\n            // out of fullscreen\n            return;\n        }\n\n        let nextElement     = document.querySelector('[data-flat-gallery-nav=\"next\"]') as HTMLElement;\n        let previousElement = document.querySelector('[data-flat-gallery-nav=\"previous\"]') as HTMLElement;\n        let captionsElement = document.querySelector('[data-role=\"flat-gallery-captions\"]') as HTMLElement;\n\n        if (null === captionsElement) {\n\n            // not rendered yet\n            return;\n        }\n\n        nextElement.style.opacity     = '1';\n        previousElement.style.opacity = '1';\n        captionsElement.style.opacity = '1';\n\n        if (true === this.animation.running) {\n            this.animation.stop();\n        }\n\n        clearTimeout(this.hideNavigationTimeout);\n\n        this.hideNavigationTimeout = setTimeout(() => {\n            this.hideNavigation();\n        }, 5000);\n    }\n}\n","import AnimationEffect from \"@fg-animations/effect\";\n\nexport default class Animation {\n\n    running: boolean;\n\n    private queue: AnimationEffect[];\n    private timer: number;\n    private frame: number;\n    private framerate: number;\n\n    constructor() {\n\n        this.queue     = [];\n        this.framerate = 60;\n        this.running   = false;\n    }\n\n    enqueue(effect: AnimationEffect) {\n        this.queue.push(effect);\n    }\n\n    animate() {\n\n        if (false === this.running) {\n\n            this.running = true;\n            this.frame   = -1;\n            this.timer   = setInterval(this.process.bind(this), 1000 / this.framerate);\n        }\n    }\n\n    process() {\n\n        this.frame += 1;\n        let done    = [];\n\n        this.queue.forEach((effect) => {\n\n            let result = effect.run(this.frame);\n\n            if (false == result) {\n                done.push(effect);\n            }\n        });\n\n        if (done.length === this.queue.length) {\n            this.stop();\n        }\n    }\n\n    stop() {\n\n        this.queue   = [];\n        this.running = false;\n\n        clearInterval(this.timer);\n    }\n}\n","import AnimationEffect from \"@fg-animations/effect\";\n\nexport default class FadeOutAnimation implements AnimationEffect {\n\n    from: number;\n    to: number;\n    speed: number;\n\n    private element: HTMLElement;\n    private framerate: number;\n    private frames: number[];\n\n    constructor(element: HTMLElement, from: number, to: number, speed: number) {\n\n        this.element   = element;\n        this.from      = from;\n        this.to        = to;\n        this.speed     = speed;\n        this.framerate = 60 * speed;\n        this.frames    = this.tween();\n    }\n\n    run(frame: number) {\n\n        if (null != this.frames[frame]) {\n\n            if (null === this.element) {\n                return false;\n            }\n\n            this.element.style.opacity = this.frames[frame].toString();\n            return true;\n        }\n\n        return false;\n    }\n\n    private tween() {\n\n        let frames    = [];\n        let tween     = (this.to - this.from) / this.framerate;\n\n        for (let i = 0; i <= this.framerate; i++) {\n            frames[i] = (this.from + (tween * i)) / 100;\n        }\n\n        return frames;\n    }\n}\n","import Navigation from \"@fg-services/navigation\";\n\nexport default class LinkGenerator {\n\n  private baseUrl: string;\n  private navigation: Navigation;\n\n  constructor(navigation: Navigation, baseUrl: string) {\n\n    this.baseUrl    = baseUrl;\n    this.navigation = navigation;\n  }\n\n  generateNavigationLinks() {\n\n    let previous = this.navigation.getPreviousImage();\n    let next     = this.navigation.getNextImage();\n    let links    = [];\n\n    if (false !== previous) {\n\n      let link = document.createElement('a');\n      link.textContent = 'Previous';\n      link.setAttribute('href', `${this.baseUrl}/${previous.id}`);\n      link.setAttribute('data-flat-gallery-nav', 'previous');\n\n      links.push(link);\n\n    } else {\n\n      let link = document.createTextNode('Previous');\n      links.push(link);\n    }\n\n    links.push(document.createTextNode(' | '));\n\n    if (false !== next) {\n\n      let link = document.createElement('a');\n      link.textContent = 'Next';\n      link.setAttribute('href', `${this.baseUrl}/${next.id}`);\n      link.setAttribute('data-flat-gallery-nav', 'next');\n\n      links.push(link);\n\n    } else {\n\n      let link = document.createTextNode('Next');\n      links.push(link);\n    }\n\n    return links;\n  }\n}\n"],"sourceRoot":""}